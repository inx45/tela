this is an adaption from tela code. still testing 
